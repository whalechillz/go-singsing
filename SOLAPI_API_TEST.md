# 솔라피 API 테스트 및 디버깅 가이드

## 🔍 현재 상황

### ✅ 완료된 사항
1. **API 인증 방식** - HMAC-SHA256 올바르게 구현
2. **환경변수 설정** - Vercel에 모두 설정됨
3. **전화번호 형식** - 하이픈 제거 처리

### ❌ 문제점
1. **계속되는 에러**: "message 필수입니다"
2. **발신번호 미등록**: 031-215-3990 등록 필요
3. **잔액 0원**: 충전 필요

## 🧪 테스트 방법

### 1. 환경변수 확인
```
https://go2.singsinggolf.kr/api/debug/check-env
```

### 2. SMS 테스트
```
https://go2.singsinggolf.kr/api/debug/test-sms
```

## 📝 솔라피 API 요청 형식 (v4)

### 현재 시도한 형식들:

#### 1차 시도 (실패)
```json
{
  "to": "01012345678",
  "from": "0312153990",
  "text": "메시지 내용",
  "type": "SMS"
}
```

#### 2차 시도 (실패)
```json
{
  "message": {
    "to": "01012345678",
    "from": "0312153990",
    "text": "메시지 내용"
  }
}
```

#### 3차 시도 (현재)
```json
{
  "to": "01012345678",
  "from": "0312153990",
  "text": "메시지 내용",
  "type": "SMS"
}
```

## 🚨 에러 메시지 분석

```
"errorCode": "ValidationError",
"errorMessage": "[["message" 필수입니다.], "to" 사용할 수 없습니다., "from" 사용할 수 없습니다., "text" 사용할 수 없습니다., "type" 사용할 수 없습니다.]"
```

이 에러는 API가 전혀 다른 형식을 기대하고 있다는 의미입니다.

## 📋 체크리스트

### 솔라피 대시보드에서:
- [ ] 발신번호 등록 (031-215-3990)
- [ ] 잔액 충전 (최소 1만원)
- [ ] API Key 권한 확인

### 코드에서:
- [x] API 인증 헤더 (HMAC-SHA256)
- [x] 환경변수 설정
- [ ] 정확한 API 요청 형식 확인 필요

## 🎯 다음 단계

1. 솔라피 공식 문서에서 `/messages/v4/send` API의 정확한 요청 형식 확인
2. 발신번호 등록
3. 잔액 충전
4. 재테스트

## 💡 추가 참고사항

- API 인증은 올바르게 구현되어 있음
- 문제는 요청 body 형식이나 발신번호 미등록
- 솔라피 v4 API 문서 재확인 필요
