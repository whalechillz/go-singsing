# 싱싱골프투어 시스템 개선 현황

## 2025년 5월 30일 현재 상황

### 🔍 시스템 현황

1. **데이터베이스 구조**
   - `tour_products`: 여행상품 템플릿 (골프장, 호텔 정보)
   - `singsing_tours`: 실제 투어 일정 (특정 날짜의 투어)
   - `singsing_participants`: 투어 참가자 정보
   - `singsing_payments`: 결제 정보

2. **구현 완료 기능**
   - ✅ 투어 스케줄 관리
   - ✅ 여행상품 관리
   - ✅ 참가자 관리
   - ✅ 결제 관리 (V3)
   - ✅ 5개 투어 상세 페이지
   - ✅ 통계 대시보드

### 📋 최근 완료 작업

#### 1. 투어 관리 페이지 구현 (2025-05-30)
- 참가자 관리: `/admin/tours/[tourId]/participants`
- 객실 배정: `/admin/tours/[tourId]/room-assignment`
- 일정 관리: `/admin/tours/[tourId]/schedule`
- 티오프 시간: `/admin/tours/[tourId]/tee-times`
- 탑승 스케줄: `/admin/tours/[tourId]/boarding`

#### 2. 결제 시스템 개선 (2025-01-27)
- 계약금(30%)/잔금(70%) 자동 계산
- 결제 상태 관리 (완료/대기/취소/환불)
- 환불 처리 기능
- 그룹 결제 최적화
- 참가자별 결제 현황 대시보드

#### 3. 참가자 관리 개선 (2025-01-27)
- 동반자 정보 UI 통합
- 그룹 인원수 관리 개선
- 일괄 결제 옵션 통합
- 동반자 개별 삭제 기능

### 🚀 즉시 실행 필요 사항

#### 1. Phase 2 DB 마이그레이션
```bash
# Supabase SQL Editor에서 순서대로 실행
1. /scripts/migration/backup_and_migrate.sql
2. /scripts/migration/check_tour_schedule_mapping.sql
3. /supabase/migrations/phase2/*.sql (001~006)
```

#### 2. 네비게이션 개선
- 투어 상세 페이지에 탭 네비게이션 추가
- 현재 개별 페이지로 분산된 기능 통합

### 📊 다음 단계 권장사항

#### Phase 4: 문서 생성 시스템 (우선순위 높음)
1. PDF 생성 라이브러리 설치
2. 6종 문서 템플릿 개발
   - 투어 일정표 (고객용)
   - 탑승지 안내 (고객용)
   - 객실 배정표 (고객용)
   - 라운딩 시간표 (고객용)
   - 탑승지 배정 (스탭용)
   - 객실 배정 (스탭용)
3. QR코드 기반 문서 접근

#### Phase 5: 권한 시스템
- Supabase Auth 설정
- RLS 정책 적용
- 사용자 역할별 접근 제어

#### Phase 6: 알림 시스템
- 솔라피 API 연동 (알림톡)
- 슬랙 연동 (내부 알림)
- 이메일 알림

### 🐛 알려진 이슈

1. **데이터 정합성**
   - 코드에서 tour_id가 실제로는 schedule_id를 참조하는 경우 존재
   - 변수명 통일 필요

2. **테이블 구조**
   - singsing_rooms 테이블이 Phase 2 설계와 다름
   - boarding 관련 테이블 정리 필요

3. **성능 최적화**
   - 참가자 수 계산 쿼리 개선 필요
   - 대량 데이터 처리 시 페이지네이션 필요

### 💡 개선 아이디어

1. **자동화 기능**
   - 객실 자동 배정 (성별, 그룹 고려)
   - 버스 좌석 최적화
   - 티오프 시간 자동 배정

2. **대시보드 강화**
   - 투어별 수익 현황
   - 참가자 통계 (연령, 성별, 지역)
   - 인기 골프장/호텔 분석

3. **고객 경험**
   - 모바일 최적화
   - 카카오톡 알림
   - 투어 사진 갤러리

---
*작성일: 2025-05-30*
