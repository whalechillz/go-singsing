# 싱싱골프투어 문서 시스템 개선 사항

## 완료된 개선사항

### 1. 여행상품 관리 개선 ✅
- **새로운 필드 추가**
  - `golf_courses`: 골프장 목록 (JSON 배열)
  - `included_items`: 포함사항 (기본값 제공)
  - `excluded_items`: 불포함사항 (기본값 제공)
  - `accommodation_info`: 숙소 상세정보
  - `general_notices`: 일반 공지사항 (JSON 배열)

- **UI 개선**
  - 신규 등록 시 기본값 자동 설정
  - 골프장 정보 동적 추가/삭제
  - 공지사항 동적 관리
  - 개선된 레이아웃과 사용성

### 2. 투어 수정 페이지 개선 ✅
- **새로운 필드 추가**
  - `reservation_notices`: 예약 안내사항 (JSON 배열)
  - `other_notices`: 기타 안내문구
  - `document_settings`: 문서별 생성 옵션

- **여행상품 연동**
  - 여행상품 선택 시 자동으로 정보 불러오기
  - 포함/불포함 사항 자동 설정

- **문서별 공지사항 통합 관리**
  - DocumentNoticeManager 컴포넌트 통합
  - 문서 타입별 공지사항 개별 관리

### 3. 문서별 공지사항 관리 시스템 ✅
- **새로운 테이블 구조**
  - `document_notices`: 투어별 문서 공지사항
  - `document_templates`: 문서 템플릿 관리

- **DocumentNoticeManager 컴포넌트**
  - 6가지 문서 타입별 공지사항 관리
  - 템플릿 적용 기능
  - 드래그 앤 드롭 (향후 구현 가능)
  - 실시간 저장

### 4. 일정표 미리보기 개선 ✅
- **6가지 문서 타입 모두 지원**
  1. 고객용 일정표
  2. 고객용 탑승안내서
  3. 스탭용 탑승안내서
  4. 객실 배정표
  5. 티타임표
  6. 간편 일정표

- **개선된 기능**
  - 여행상품 정보 자동 반영
  - 문서별 공지사항 표시
  - 투어 설정에 따른 문서 활성화/비활성화
  - HTML 다운로드 기능

### 5. 문서 관리 페이지 개선 ✅
- **통합 관리 인터페이스**
  - 문서 목록 탭
  - 템플릿 관리 탭
  - 투어별 공지사항 탭

- **템플릿 시스템**
  - 문서 타입별 템플릿 생성
  - 기본 템플릿 설정
  - 템플릿 재사용

### 6. 데이터베이스 개선 ✅
- **통합 뷰 생성**
  - `tour_schedule_full_view`: 투어와 여행상품 정보 통합
  - `tour_document_status`: 문서 생성 상태 확인

- **데이터 구조 개선**
  - JSON 타입 활용으로 유연한 데이터 관리
  - 관계형 데이터와 문서형 데이터의 효율적 결합

## 시스템 아키텍처

```
┌─────────────────────────────────────────────────────────┐
│                    프론트엔드 (Next.js)                    │
├─────────────────────────────────────────────────────────┤
│  여행상품 관리  │  투어 관리  │  문서 생성  │  미리보기    │
└─────────────────┬───────────────────────────────────────┘
                  │
┌─────────────────▼───────────────────────────────────────┐
│                  데이터베이스 (Supabase)                   │
├─────────────────────────────────────────────────────────┤
│  tour_products  │  singsing_tours  │  document_notices   │
│  document_templates  │  tour_schedule_full_view (뷰)     │
└─────────────────────────────────────────────────────────┘
```

## 데이터 흐름

1. **여행상품 생성** → 기본 정보 및 공지사항 설정
2. **투어 생성** → 여행상품 선택 → 정보 자동 불러오기
3. **문서 설정** → 문서별 공지사항 추가/수정
4. **문서 생성** → 모든 정보 통합하여 문서 생성
5. **미리보기/다운로드** → 최종 문서 확인 및 배포

## 향후 개선 가능 사항

1. **드래그 앤 드롭**
   - 공지사항 순서 변경
   - 콘텐츠 블록 재배열

2. **버전 관리**
   - 문서 변경 이력 추적
   - 이전 버전 복원 기능

3. **다중 언어 지원**
   - 영어, 중국어 등 다국어 문서 생성

4. **PDF 직접 생성**
   - 서버사이드 PDF 렌더링
   - 일괄 다운로드 기능

5. **알림 시스템**
   - 문서 생성 완료 알림
   - 변경사항 통지

## 사용 가이드

### 1. 여행상품 등록
```
1. 관리자 페이지 → 여행상품 관리
2. "새 상품" 클릭
3. 기본 정보 입력 (기본값 자동 설정됨)
4. 골프장 정보 추가
5. 공지사항 수정/추가
6. 저장
```

### 2. 투어 생성 및 문서 설정
```
1. 관리자 페이지 → 투어 관리
2. "새 투어" 클릭
3. 여행상품 선택 (정보 자동 불러오기)
4. 투어 정보 입력
5. "문서 설정" 탭에서:
   - 생성할 문서 선택
   - 문서별 공지사항 관리
6. 저장
```

### 3. 문서 미리보기 및 다운로드
```
1. 투어 상세 페이지 → "일정표 미리보기"
2. 원하는 문서 타입 선택
3. 미리보기 확인
4. "HTML 다운로드" 클릭
```

## 문제 해결

### Q: 문서에 정보가 누락되었어요
A: 다음 사항을 확인하세요:
- 여행상품 정보가 완전히 입력되었는지
- 투어 수정 페이지에서 모든 정보가 저장되었는지
- 문서별 공지사항이 저장되었는지

### Q: 특정 문서가 보이지 않아요
A: 투어 수정 → 문서 설정에서 해당 문서가 활성화되어 있는지 확인하세요.

### Q: 템플릿을 수정하고 싶어요
A: 문서 관리 → 템플릿 관리에서 새 템플릿을 만들거나 기존 템플릿을 삭제 후 재생성하세요.

### Q: 공지사항과 문서 하단 내용의 차이는 무엇인가요?
A: 
- 공지사항: 투어 전체에 적용되는 일반 안내사항
- 문서 하단 내용: 각 문서별로 표시되는 개별 안내사항 (라운딩 주의사항, 탑승 주의사항 등)

## 문서별 하단 내용 관리 시스템 개선 (2024.06.03)

### 개선 배경
기존 일정 관리(통합)의 공지사항이 각각 다른 문서의 하단에 표시되는 구조를 개선하여, 문서별로 개별 하단 내용을 관리할 수 있도록 개선하였습니다.

### 개선 내용
1. **새로운 테이블 생성**
   - `document_footers` 테이블 추가
   - 투어별, 문서 타입별 하단 내용 관리

2. **DocumentFooterManager 컴포넌트**
   - 문서별 하단 내용 통합 관리 UI
   - 탭 형식으로 문서별 내용 편집

3. **문서별 하단 내용**
   - 라운딩 시간표: 라운딩 주의사항
   - 탑승지 안내: 탑승 주의사항
   - 객실 배정: 객실 이용 안내, 식사 안내
   - 전체 일정표: 락카 이용 안내

### 사용 방법
1. 일정 관리(통합) > 문서 하단 내용 탭 선택
2. 각 문서별로 하단에 표시할 내용 편집
3. 저장 후 문서 생성 시 자동 반영

### 장점
- 문서별로 개별 내용 관리 가능
- 기존 공지사항과 분리하여 명확한 구조
- 탬플릿 지원으로 일관성 있는 문서 생성