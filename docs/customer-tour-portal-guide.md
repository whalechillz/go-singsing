# 통합 표지(포털) 기능 구현

## 개요
고객들이 투어 관련 모든 문서를 한곳에서 쉽게 접근할 수 있도록 시각적인 통합 표지(포털) 페이지를 제공하는 기능입니다.

## 주요 기능 업데이트 (2025.06.12)

### 1. D-Day 표시 기능
- **D-X**: 투어 시작 전 남은 일수 표시
- **진행중**: 투어 진행 중일 때 표시
- **D+X**: 투어 종료 후 경과 일수 표시
- **종료됨**: 투어 종료 7일 이후 표시

### 2. 투어 종료 후 회원가입 유도
- 투어 종료 7일 후 포털 비활성화 예정 안내
- 회원가입 버튼으로 투어 기록 보관 유도

### 3. 통합 문서 미리보기 (iframe)
- 통합 문서 카드 클릭 시 iframe으로 바로 표시
- 새 탭에서 열기 옵션 제공
- 탭으로 문서 전환 가능 안내

## 구현 내용

### 1. 신규 라우트
- `/portal/[url]` - 통합 표지 페이지

### 2. 컴포넌트
- `CustomerTourPortal.tsx` - 고객용 통합 표지 UI 컴포넌트
  - 모바일 최적화된 반응형 디자인
  - 5가지 테마 색상 선택 가능
  - 비상연락처 섹션
  - 문서 카드 그리드 레이아웃

### 3. 기능 추가
- 문서 링크 관리 페이지(`/admin/tours/[tourId]/document-links`)에 통합 표지 생성 버튼 추가
- 포털 생성 모달 UI
  - 테마 선택
  - 비상연락처 설정
  - 표시 옵션 설정

### 4. 데이터베이스 변경
- `public_document_links` 테이블에 `settings` JSONB 컬럼 추가
- 포털 설정 정보 저장
  - theme: 테마 색상
  - showContact: 연락처 표시 여부
  - enableThemeSelector: 테마 변경 허용 여부
  - contactNumbers: 비상연락처 정보

## 사용자 경험

### 관리자
1. 투어 문서 링크 관리 페이지에서 "통합 표지 생성" 버튼 클릭
2. 테마 색상, 연락처 정보, 표시 옵션 설정
3. 생성된 포털 링크를 고객에게 공유

### 고객
1. 공유받은 포털 링크 접속
2. 모든 투어 문서를 한눈에 확인
3. 원하는 문서 카드 클릭하여 상세 내용 확인
4. 테마 변경 가능 (설정에 따라)
5. 비상연락처 바로 연결

## 주요 특징
- 📱 모바일 우선 반응형 디자인
- 🎨 5가지 테마 색상 제공
- 🚀 빠른 접근성
- 🎯 직관적인 UI/UX
- 📞 비상연락처 원터치 연결
- 🔗 개별 문서 링크 공유 기능
- ⏰ D-Day 표시로 투어 상태 한눈에 확인
- 📄 통합 문서 iframe 미리보기

## 마이그레이션
```sql
-- 통합 표지(포털) 기능을 위한 settings 컬럼 추가
ALTER TABLE public_document_links 
ADD COLUMN IF NOT EXISTS settings JSONB;
```

## 통합 문서 표시 방식 비교

### 1. iframe 미리보기 방식 (현재 구현)
**장점:**
- 페이지 이동 없이 바로 확인 가능
- 포털 페이지에서 모든 것을 원스톱으로 처리
- 사용자 경험이 끊기지 않음

**단점:**
- 모바일에서 iframe 내 스크롤이 불편할 수 있음
- 화면이 복잡해 보일 수 있음

### 2. 단순 링크 방식
**장점:**
- 깔끔하고 단순한 UI
- 사용자가 익숙한 방식

**단점:**
- 통합 문서의 장점을 시각적으로 전달하기 어려움
- 새 탭/창으로 이동해야 함

## 추후 개선사항
- QR코드 생성 기능
- 전체 링크 일괄 복사
- 포털 페이지 통계 분석
- 커스텀 브랜딩 옵션
- PWA(프로그레시브 웹 앱) 지원
- 오프라인 접근 기능
